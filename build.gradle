plugins {
    id "org.jetbrains.intellij" version "0.2.17"
}

subprojects {

    apply plugin: 'org.jetbrains.intellij'
    apply plugin: 'java'


    configurations {
        gen
    }

    repositories {
        mavenLocal()
        mavenCentral()
        maven {
            url "http://central.maven.org/maven2/"
        }
        maven {
            url 'https://oss.sonatype.org/content/repositories/snapshots'
        }
        maven {
            url "https://repository.mulesoft.org/releases/"
        }
        maven {
            url "http://repository.mulesoft.org/snapshots/"
        }
        maven {
            url "https://repository.mulesoft.org/nexus/content/repositories/releases"
        }
    }

    sourceCompatibility = javaVersion
    targetCompatibility = javaVersion
    tasks.withType(JavaCompile) { options.encoding = 'UTF-8' }
    group = 'org.mule.tooling.intellij'

    task jarSources(type: Jar) {
        from sourceSets.main.allSource
        classifier = 'sources'
    }

    assemble.dependsOn jarSources

    intellij {
        version = ideaVersion
        updateSinceUntilBuild = false
        downloadSources = false
        sandboxDirectory = "${rootProject.buildDir}/idea-sandbox"
        publish {
            username System.getenv('IJ_REPO_USERNAME')
            password System.getenv('IJ_REPO_PASSWORD')
            pluginId '10362'
            channel ijPluginRepoChannel
        }
    }
}


